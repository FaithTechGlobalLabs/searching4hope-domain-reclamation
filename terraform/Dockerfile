FROM hashicorp/terraform:light

ARG AWS_ACCESS_KEY_ID
ARG AWS_SECRET_ACCESS_KEY
ARG AWS_DEFAULT_REGION="us-west-2"
ARG DOMAIN_NAME

ENV AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID}
ENV AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY}
ENV TF_VAR_site_domain=${DOMAIN_NAME}

COPY *.tf ./

RUN terraform init
RUN terraform plan